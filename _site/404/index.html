<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="es" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>jflabur.io</title>
<meta name="description" content="Art√≠culos sobre ciberseguridad, CTFs e investigaciones">



<meta property="og:type" content="website">
<meta property="og:locale" content="es_ES">
<meta property="og:site_name" content="jflabur.io">
<meta property="og:title" content="jflabur.io">
<meta property="og:url" content="http://localhost:4000/404/">












  

  


<link rel="canonical" href="http://localhost:4000/404/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Jflabur",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="jflabur.io Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--default">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Art√≠culos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categor√≠as</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/videos/" >V√≠deos</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      <style type="text/css" media="screen">
  .container {
    margin: 10px auto;
    max-width: 600px;
    text-align: center;
  }
  h1 {
    margin: 30px 0;
    font-size: 4em;
    line-height: 1;
    letter-spacing: -1px;
  }
</style>

<div class="container">
  <h1>404</h1>

  <p><strong>Page not found :(</strong></p>
  <p>The requested page could not be found.
  
  
    <article id="post-1215" class="posts-entry fbox post-1215 post type-post status-publish format-standard hentry category-hackthebox tag-ctf tag-hackthebox tag-htb tag-linux tag-passage">
	<header class="entry-header">
		<h1 class="entry-title">HackTheBox ‚Äì Passage ‚Äì WriteUp</h1>			<div class="blog-data-wrapper">
				<div class="post-data-text">
					<span class="posted-on">Posted on <a href="https://binarybiceps.com/hackthebox-passage-writeup/" rel="bookmark"><time class="entry-date published" datetime="2020-09-06T07:25:07+05:30">September 6, 2020</time><time class="updated" datetime="2020-09-10T08:08:08+05:30">September 10, 2020</time></a></span><span class="byline"> </span>			</div>
		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
				<div data-elementor-type="wp-post" data-elementor-id="1215" class="elementor elementor-1215" data-elementor-settings="[]">
						<div class="elementor-inner">
							<div class="elementor-section-wrap">
							<section class="elementor-section elementor-top-section elementor-element elementor-element-1788d16 elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-id="1788d16" data-element_type="section">
						<div class="elementor-container elementor-column-gap-default">
							<div class="elementor-row">
					<div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-166b2eb" data-id="166b2eb" data-element_type="column">
			<div class="elementor-column-wrap elementor-element-populated">
							<div class="elementor-widget-wrap">
						<div class="elementor-element elementor-element-af6eddd elementor-widget elementor-widget-text-editor" data-id="af6eddd" data-element_type="widget" data-widget_type="text-editor.default">
				<div class="elementor-widget-container">
					<div class="elementor-text-editor elementor-clearfix"><p><img loading="lazy" class="aligncenter wp-image-1217 size-full" title="Info-Card-Passage" src="https://binarybiceps.com/wp-content/uploads/2020/09/Info-Card-Passage.png" alt="Info-Card-Passage" width="772" height="424" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/Info-Card-Passage.png 772w, https://binarybiceps.com/wp-content/uploads/2020/09/Info-Card-Passage-300x165.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/Info-Card-Passage-768x422.png 768w" sizes="(max-width: 772px) 100vw, 772px"></p><p>Hello fellow hackers! Welcome to another writeup in the <a href="https://binarybiceps.com/category/writeups/hackthebox/">HackTheBox</a> writeup series. This writeup will explain the detailed explanation of the brand new machine ‚ÄúPassage‚Äù from Hackthebox. Its difficulty is rated as Medium. Let‚Äôs go and Pwn this.</p><p><strong>Disclaimer Readers: </strong>I intentionally skipped some steps to avoid copy-catting and also to resist freebie flag takers. If you already have done the machine, you will come to know the part which I skipped. I hope you all friends understand the work behind creating a unique Vulnerable machine by creators and the content writers who passionately trying to teach something differently/qualitatively. Thanks for the understanding and support.</p><div id="ez-toc-container" class="ez-toc-v2_0_11 counter-hierarchy counter-decimal ez-toc-grey">
<div class="ez-toc-title-container">
<p class="ez-toc-title">Table of Contents</p>
<span class="ez-toc-title-toggle"><a class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle"><i class="ez-toc-glyphicon ez-toc-icon-toggle"></i></a></span></div>
<nav><ul class="ez-toc-list ez-toc-list-level-1"><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-1" href="#Information_Gathering" title="Information Gathering:">Information Gathering:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-2" href="#Web_Enumeration" title="Web Enumeration:">Web Enumeration:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-3" href="#CVE_%E2%80%93_Arbitrary_File_Upload_%E2%80%93_wwwdata_Shell" title="CVE ‚Äì Arbitrary File Upload ‚Äì www-data Shell:">CVE ‚Äì Arbitrary File Upload ‚Äì www-data Shell:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-4" href="#Decrypting_Hashes_%E2%80%93_Paul_Shell" title="Decrypting Hashes ‚Äì Paul Shell:">Decrypting Hashes ‚Äì Paul Shell:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-5" href="#Same_SSH_Keys_%E2%80%93_Nadav_Shell" title="Same SSH Keys ‚Äì Nadav Shell:">Same SSH Keys ‚Äì Nadav Shell:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-6" href="#Dbus_%E2%80%93_USB_Creator_Privilege_Escalation_%E2%80%93_Root" title="Dbus ‚Äì USB Creator Privilege Escalation ‚Äì Root:">Dbus ‚Äì USB Creator Privilege Escalation ‚Äì Root:</a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-7" href="#The_Machine_is_Rooted_%F0%9F%98%89" title="The Machine is Rooted üòâ">The Machine is Rooted <img draggable="false" role="img" class="emoji" alt="üòâ" src="https://s.w.org/images/core/emoji/13.0.0/svg/1f609.svg"></a></li></ul></nav></div>
<h2><span class="ez-toc-section" id="Information_Gathering"></span>Information Gathering:<span class="ez-toc-section-end"></span></h2><p>As usual, starting the machine with our favorite Nmap to establish open ports and also to find services running on those ports.</p><pre class="wp-block-code"><code>Passage ‚ûú nmap -sC -sV -p- 10.10.10.206

PORT    STATE  SERVICE VERSION
22/tcp  open   ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)
|   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)
|   256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)
80/tcp  open   http    Apache httpd 2.4.18 ((Ubuntu))
| http-server-header: Apache/2.4.18 (Ubuntu)
| http-title: Passage News</code></pre><p>Only two ports were opened. We can conclude that our foothold must be in port 80.</p><ul><li>Port 22 ‚Äì SSHD service.</li><li>Port 80 ‚Äì Apache Web Server.</li></ul><h2><span class="ez-toc-section" id="Web_Enumeration"></span>Web Enumeration:<span class="ez-toc-section-end"></span></h2><p><img loading="lazy" class="aligncenter wp-image-1219 size-full" title="Main Web Page." src="https://binarybiceps.com/wp-content/uploads/2020/09/web1-passage.png" alt="Main Web Page." width="757" height="437" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/web1-passage.png 757w, https://binarybiceps.com/wp-content/uploads/2020/09/web1-passage-300x173.png 300w" sizes="(max-width: 757px) 100vw, 757px"></p><p>We were welcomed with a News page. There is nothing interesting except a disclosure about NMS (News Management System) ‚ÄòCutenews‚Äô.</p><p><img loading="lazy" class="aligncenter wp-image-1220 size-full" title="CuteNews NMS." src="https://binarybiceps.com/wp-content/uploads/2020/09/web2-passage.png" alt="CuteNews NMS." width="536" height="155" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/web2-passage.png 536w, https://binarybiceps.com/wp-content/uploads/2020/09/web2-passage-300x87.png 300w" sizes="(max-width: 536px) 100vw, 536px"></p><p>From the bottom of the page, we can see this. After some googling, I found that we can visit the NMS panel after placing ‚ÄòCuteNews‚Äô on the web page.</p><p><img loading="lazy" class="aligncenter wp-image-1221 size-full" title="Sign-in/Register page." src="https://binarybiceps.com/wp-content/uploads/2020/09/web3-passage.png" alt="Sign-in/Register page." width="682" height="557" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/web3-passage.png 682w, https://binarybiceps.com/wp-content/uploads/2020/09/web3-passage-300x245.png 300w" sizes="(max-width: 682px) 100vw, 682px"></p><p>Huh? A Sign-in/Register panel. I quickly signed in and crawled through it. But nothing I found useful. Interestingly, I got the version of CuteNews in the same page.</p><p><img loading="lazy" class="aligncenter wp-image-1222 size-full" title="Vulnerable CuteNews version." src="https://binarybiceps.com/wp-content/uploads/2020/09/web4-passage.png" alt="Vulnerable CuteNews version." width="365" height="130" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/web4-passage.png 365w, https://binarybiceps.com/wp-content/uploads/2020/09/web4-passage-300x107.png 300w" sizes="(max-width: 365px) 100vw, 365px"></p><p>CuteNews Version ‚Äì 2.1.2</p><h2><span class="ez-toc-section" id="CVE_%E2%80%93_Arbitrary_File_Upload_%E2%80%93_wwwdata_Shell"></span>CVE ‚Äì Arbitrary File Upload ‚Äì www-data Shell:<span class="ez-toc-section-end"></span></h2><p>After some time spending on google for Public exploits, I found the below article in Exploit-DB.</p><p>CuteNews ‚Äì Avatar Abusing: <a href="https://www.exploit-db.com/exploits/37474">https://www.exploit-db.com/exploits/37474</a></p><p>Based on the reference above, we can upload a malicious JPG file containing malicious PHP code in it to cause RCE.</p><p>Just like the <a href="https://binarybiceps.com/hackthebox-magic-writeup/">Magic</a> machine, we can writeup our PHP code inside an image file using the ‚ÄòExifTool‚Äô tool.</p><p><img loading="lazy" class="aligncenter wp-image-1224 size-full" title="Inserting PHP code inside JPG file." src="https://binarybiceps.com/wp-content/uploads/2020/09/cute1-passage-e1599360909586.png" alt="Inserting PHP code inside JPG file." width="957" height="255" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/cute1-passage-e1599360909586.png 957w, https://binarybiceps.com/wp-content/uploads/2020/09/cute1-passage-e1599360909586-300x80.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/cute1-passage-e1599360909586-768x205.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/cute1-passage-e1599360909586-850x226.png 850w" sizes="(max-width: 957px) 100vw, 957px"></p><p>Let‚Äôs register an account and upload it to the avatar section.</p><p><img loading="lazy" class="aligncenter wp-image-1225 size-full" title="Uploading malicious PHP file in Avatar section." src="https://binarybiceps.com/wp-content/uploads/2020/09/cute2-passage.png" alt="Uploading malicious PHP file in Avatar section." width="771" height="434" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/cute2-passage.png 771w, https://binarybiceps.com/wp-content/uploads/2020/09/cute2-passage-300x169.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/cute2-passage-768x432.png 768w" sizes="(max-width: 771px) 100vw, 771px"></p><p>After saving changes, we can now able to visit the location of our uploaded PHP file.</p><p><img loading="lazy" class="aligncenter wp-image-1227 size-full" title="www-data web shell." src="https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage.png" alt="www-data web shell." width="1267" height="151" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage.png 1267w, https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage-300x36.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage-1024x122.png 1024w, https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage-768x92.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/cute3-passage-850x101.png 850w" sizes="(max-width: 1267px) 100vw, 1267px"></p><p>We got the www-data web shell in our Browser. After some crawling, I found that NC is available there in the box. So, without hesitation, I started a listener in my machine to catch the reverse shell.</p><p><img loading="lazy" class="aligncenter wp-image-1228 size-full" title="Reverse Shell as www-data." src="https://binarybiceps.com/wp-content/uploads/2020/09/cute4-passage.png" alt="Reverse Shell as www-data." width="965" height="371" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/cute4-passage.png 965w, https://binarybiceps.com/wp-content/uploads/2020/09/cute4-passage-300x115.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/cute4-passage-768x295.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/cute4-passage-850x327.png 850w" sizes="(max-width: 965px) 100vw, 965px"></p><p>Voila! We got our www-data shell.</p><h2><span class="ez-toc-section" id="Decrypting_Hashes_%E2%80%93_Paul_Shell"></span>Decrypting Hashes ‚Äì Paul Shell:<span class="ez-toc-section-end"></span></h2><p>Interestingly, there is a lot of PHP files available to read. I saved all the outputs to a single file and copied it to my machine.</p><p><img loading="lazy" class="aligncenter wp-image-1229 size-full" title="Multiple PHP files contains b64 strings." src="https://binarybiceps.com/wp-content/uploads/2020/09/paul1-passage.png" alt="Multiple PHP files contains b64 strings." width="980" height="208" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/paul1-passage.png 980w, https://binarybiceps.com/wp-content/uploads/2020/09/paul1-passage-300x64.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/paul1-passage-768x163.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/paul1-passage-850x180.png 850w" sizes="(max-width: 980px) 100vw, 980px"></p><p>Wrote a simple Python script to remove odd lines from the output file.</p><pre class="wp-block-code"><code>Passage ‚ûú parse.py
f = open('new_out.txt', 'w')
l = open('output.txt', 'rt')
for all in l:
	new_line = all.replace("**that PHP snippet**<!--?php die('Direct call - access denied'); ?-->", "")
	f = open('new_out.txt', 'a')
	f.write(new_line)

l.close()
f.close()</code></pre><p>Let‚Äôs decode all the base64 strings.</p><p><img loading="lazy" class="aligncenter wp-image-1230 size-full" title="SHA2-256 Hashes." src="https://binarybiceps.com/wp-content/uploads/2020/09/paul2-passage.png" alt="SHA2-256 Hashes." width="925" height="258" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/paul2-passage.png 925w, https://binarybiceps.com/wp-content/uploads/2020/09/paul2-passage-300x84.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/paul2-passage-768x214.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/paul2-passage-850x237.png 850w" sizes="(max-width: 925px) 100vw, 925px"></p><p>We got&nbsp; 6 SHA2-256 Hashes. Let‚Äôs fire Hashcat to crack this against the rockyou.txt file.</p><pre class="wp-block-code"><code>hashcat -m 1400 -a 0 hash_hashcat /root/Downloads/Seclists/rockyou.txt</code></pre><p>It took 5 seconds to throw the cracked password for two hashes.</p><p><img loading="lazy" class="aligncenter wp-image-1231 size-full" title="Two hashes got cracked." src="https://binarybiceps.com/wp-content/uploads/2020/09/paul3-passage.png" alt="Two hashes got cracked." width="969" height="99" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/paul3-passage.png 969w, https://binarybiceps.com/wp-content/uploads/2020/09/paul3-passage-300x31.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/paul3-passage-768x78.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/paul3-passage-850x87.png 850w" sizes="(max-width: 969px) 100vw, 969px"></p><p>SSH is not allowed to log-in with Password. So I tried to SU into Paul.</p><p><img loading="lazy" class="aligncenter wp-image-1232 size-full" title="User Flag owned." src="https://binarybiceps.com/wp-content/uploads/2020/09/userflag-passage.png" alt="User Flag owned." width="761" height="260" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/userflag-passage.png 761w, https://binarybiceps.com/wp-content/uploads/2020/09/userflag-passage-300x102.png 300w" sizes="(max-width: 761px) 100vw, 761px"></p><p>Hooray! We just owned the User flag.</p><h2><span class="ez-toc-section" id="Same_SSH_Keys_%E2%80%93_Nadav_Shell"></span>Same SSH Keys ‚Äì Nadav Shell:<span class="ez-toc-section-end"></span></h2><p>Nadav uses the same SSH key for Paul.</p><p><img loading="lazy" class="aligncenter wp-image-1233 size-full" title="Paul has same SSH key as Nadav." src="https://binarybiceps.com/wp-content/uploads/2020/09/nadav1-passage.png" alt="Paul has same SSH key as Nadav." width="975" height="298" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/nadav1-passage.png 975w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav1-passage-300x92.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav1-passage-768x235.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav1-passage-850x260.png 850w" sizes="(max-width: 975px) 100vw, 975px"></p><p>I copied the id_rsa to my machine and SSH into Nadav.</p><p><img loading="lazy" class="aligncenter wp-image-1234 size-full" title="SSH into Nadav." src="https://binarybiceps.com/wp-content/uploads/2020/09/nadav2-passage.png" alt="SSH into Nadav." width="968" height="171" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/nadav2-passage.png 968w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav2-passage-300x53.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav2-passage-768x136.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/nadav2-passage-850x150.png 850w" sizes="(max-width: 968px) 100vw, 968px"></p><p>We‚Äôre Nadav in the server now. Since he is in multiple groups, I tried to list Sudo privileges. Unfortunately, it asked for a password which we don‚Äôt have.</p><h2><span class="ez-toc-section" id="Dbus_%E2%80%93_USB_Creator_Privilege_Escalation_%E2%80%93_Root"></span>Dbus ‚Äì USB Creator Privilege Escalation ‚Äì Root:<span class="ez-toc-section-end"></span></h2><p>&nbsp;&nbsp;&nbsp;&nbsp; The .viminfo file inside Nadav‚Äôs home directory gave me a hint for Root.</p><p><img loading="lazy" class="aligncenter wp-image-1245 size-full" title="Viminfo - Dbus USB Creator." src="https://binarybiceps.com/wp-content/uploads/2020/09/root-vim-passage.png" alt="Viminfo - Dbus USB Creator." width="874" height="290" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/root-vim-passage.png 874w, https://binarybiceps.com/wp-content/uploads/2020/09/root-vim-passage-300x100.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/root-vim-passage-768x255.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/root-vim-passage-850x282.png 850w" sizes="(max-width: 874px) 100vw, 874px"></p><p>Dbus ‚Äì USBCreator ‚Äì Priviesc: <a href="https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/">https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/</a></p><h4>Pre Requirements:</h4><ul><li>The user must be in the Sudoers group. Here in our case, Nadav is in the Sudoers group.</li><li>The user must have executable privileges to the dbus tool.</li></ul><p><img loading="lazy" class="aligncenter wp-image-1237 size-full" title="Exeutable privilege for dbus-daemon" src="https://binarybiceps.com/wp-content/uploads/2020/09/root2-passage.png" alt="Exeutable privilege for dbus-daemon" width="871" height="75" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/root2-passage.png 871w, https://binarybiceps.com/wp-content/uploads/2020/09/root2-passage-300x26.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/root2-passage-768x66.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/root2-passage-850x73.png 850w" sizes="(max-width: 871px) 100vw, 871px"></p><p>Okay! We have everything we need. Let‚Äôs launch our attack. As we already know the dbus system block as ‚Äúcom.ubuntu.USBCreator‚Äù by default, we can send a system call to Dbus message.</p><p><img loading="lazy" class="aligncenter wp-image-1238 size-full" title="Running the PrivEsc exploit." src="https://binarybiceps.com/wp-content/uploads/2020/09/root3-passage-e1599705306531.png" alt="Running the PrivEsc exploit." width="967" height="256" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/root3-passage-e1599705306531.png 967w, https://binarybiceps.com/wp-content/uploads/2020/09/root3-passage-e1599705306531-300x79.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/root3-passage-e1599705306531-768x203.png 768w, https://binarybiceps.com/wp-content/uploads/2020/09/root3-passage-e1599705306531-850x225.png 850w" sizes="(max-width: 967px) 100vw, 967px"></p><p>**<strong><em>I Intentionally skipped the gdbus part to avoid freebie flag takers</em></strong>**</p><p>Just like in that article, we did all the things without getting any errors. Let‚Äôs try to SSH into Root.</p><p><img loading="lazy" class="aligncenter wp-image-1239 size-full" title="Root Flag owned." src="https://binarybiceps.com/wp-content/uploads/2020/09/rootflag-passage.png" alt="Root Flag owned." width="851" height="198" srcset="https://binarybiceps.com/wp-content/uploads/2020/09/rootflag-passage.png 851w, https://binarybiceps.com/wp-content/uploads/2020/09/rootflag-passage-300x70.png 300w, https://binarybiceps.com/wp-content/uploads/2020/09/rootflag-passage-768x179.png 768w" sizes="(max-width: 851px) 100vw, 851px"></p><p>Boom! Boom! Boom! We made it. Finally got our Fourth shell as Root Shell and we just owned the Root flag.</p><h2><span class="ez-toc-section" id="The_Machine_is_Rooted_%F0%9F%98%89"></span>The Machine is Rooted <img draggable="false" role="img" class="emoji" alt="üòâ" src="https://s.w.org/images/core/emoji/13.0.0/svg/1f609.svg"><span class="ez-toc-section-end"></span></h2><p>Hope you all enjoyed the cute ride. If you have any queries, doubts, and feedback, please leave it in the comment section. I truly respect every relationship I make from this blog. This is the <a href="https://binarybiceps.com/my-story/">Author‚Äôs Story</a> from Chemical Engineer to InfoSec.</p></div>
				</div>
				</div>
						</div>
					</div>
		</div>
								</div>
					</div>
		</section>
						</div>
						</div>
					</div>
		
				</div><!-- .entry-content -->
	</article>
  
  
  </p>
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Jflabur</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
